"use strict";function createTextElement(e){return createElement("TEXT_ELEMENT",{nodeValue:e})}function createElement(e,t,...n){const c=Object.assign({},t),o=n.length>0?[].concat(...n):[];return c.children=o.filter(e=>null!==e&&!1!==e).map(e=>e instanceof Object?e:createTextElement(e)),{type:e,props:c}}function updateDomPorperties(e,t,n){const c=e=>e.startsWith("on"),o=e=>!c(e)&&"children"!=e;Object.keys(t).filter(c).forEach(n=>{const c=n.toLowerCase().substring(2);e.removeEventListener(c,t[n])}),Object.keys(t).filter(o).forEach(t=>e[t]=null),Object.keys(n).filter(c).forEach(t=>{const c=t.toLowerCase().substring(2);e.addEventListener(c,n[t])}),Object.keys(n).filter(o).forEach(t=>e[t]=n[t])}function instantiate(e){const{type:t,props:n}=e;if("string"==typeof t){const c="TEXT_ELEMENT"===t?document.createTextNode(""):document.createElement(t);updateDomPorperties(c,[],n);const o=(n.children||[]).map(instantiate);return o.map(e=>e.dom).forEach(e=>c.appendChild(e)),{dom:c,element:e,childInstances:o}}{const t={},n=createPubilcInstance(e,t),c=instantiate(n.render()),o=c.dom;return Object.assign(t,{dom:o,element:e,childInstance:c,publicInstance:n}),t}}function reconcileChildren(e,t){const{dom:n,childInstances:c}=e,o=t.props.children||[],r=[],s=Math.max(c.length,o.length);for(let e=0;e<s;e++){const t=reconcile(n,c[e],o[e]);r.push(t)}return r}function createPubilcInstance(e,t){const{type:n,props:c}=e,o=new n(c);return o.__internalInstance=t,o}function updateInstance(e){reconcile(e.dom.parentDom,e,e.element)}function reconcile(e,t,n){if(null===t){const t=instantiate(n);return e.appendChild(t.dom),t}if(null===n)return e.removeChild(t.dom),null;if(t.element.type!==n.type){const c=instantiate(n);return e.replaceChild(c.dom,t.dom),c}if("string"==typeof n.type)return updateDomPorperties(t.dom,t.element.props,n.props),t.childInstances=reconcileChildren(t,n),t.element=n,t;{t.publicInstance.props=n.props;const c=t.publicInstance.render(),o=reconcile(e,t.childInstance,c);return t.dom=o.dom,t.childInstance=o,t.element=n,t}}let rootInstance=null;function render(e,t){console.log("element is:",e);const n=rootInstance;console.log("prevInstance is:",n);const c=reconcile(t,n,e);console.log("nextInstance is:",c),rootInstance=c}class Component{constructor(e,t){this.props=e,this.context=t,this.state=this.state||{}}setState(e){this.state=Object.assign({},this.state,e),updateInstance(this.__internalInstance)}}const React={createElement:createElement,render:render,Component:Component};var src=React.default||React;module.exports=src;
